---
title: 日期格式化线程安全问题
---
一直是用
```java
private static SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
```这种形式来格式化字符串日期,没想到原来是非线程安全的

在多线程环境下会共享 SimpleDateFormat 里面的一个Calendar.而 calendar引用会在格式化parse的时候进行clear()操作
这样就有可能一个线程在parse的时候,另一个线程的已经读错了,导致意外结果.

有两种解决方法:
--------

1. 同步代码块

2. 线程中单独实例化


另
--------

Java8 提供了 DateTimeFormatter,本身就是thread -safe了,所以,放心用吧,java8的日期组件还是很方便的.